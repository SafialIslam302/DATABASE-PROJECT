DROP TABLE MATCH_DETAILS cascade constraints;
DROP TABLE SEAT_AVAILABLE cascade constraints;
DROP TABLE TICKET_PRICE cascade constraints;
DROP TABLE BUYER_DETAILS cascade constraints;
DROP TABLE TICKET_INFO cascade constraints;

CREATE TABLE MATCH_DETAILS(
	MATCH_NO NUMBER(10) NOT NULL,
	MATCH_VANUE VARCHAR(20),
	MATCH_TIME DATE,
	MATCH_TYP VARCHAR(20),
	TEAM_NAME1 VARCHAR(10),
	TEAM_NAME2 VARCHAR(10),
	TICKET_CATEGORY NUMBER(10) check(TICKET_CATEGORY >= 1 and TICKET_CATEGORY <= 4)
);

CREATE TABLE SEAT_AVAILABLE(
	MATCH_NO NUMBER(10),
	SEAT_AVAILABLE_IN_TOTAL NUMBER(10)
);

CREATE TABLE BUYER_DETAILS(
	BUYER_ID VARCHAR(10) NOT NULL,
	TICKET_ID VARCHAR(10),
	NO_OF_SEAT_NEEDED NUMBER(10) check(NO_OF_SEAT_NEEDED >= 1 and NO_OF_SEAT_NEEDED <= 4)
);

CREATE TABLE TICKET_INFO(
	TICKET_ID VARCHAR(10) NOT NULL,
	SEAT_NO VARCHAR(10),
	SEAT_TYP VARCHAR(10),
	MATCH_NO NUMBER(10)
);

CREATE TABLE TICKET_PRICE(
	TICKET_CATEGORY NUMBER(10) NOT NULL,
	MATCH_TYP VARCHAR(10), 
	TI_PRICE NUMBER(10)
);

ALTER TABLE MATCH_DETAILS ADD CONSTRAINT MDP_KEY PRIMARY KEY(MATCH_NO);
ALTER TABLE BUYER_DETAILS ADD CONSTRAINT BDP_KEY PRIMARY KEY(BUYER_ID);
ALTER TABLE TICKET_INFO ADD CONSTRAINT TIP_KEY PRIMARY KEY(TICKET_ID);
ALTER TABLE TICKET_PRICE ADD CONSTRAINT TPP_KEY PRIMARY KEY(TICKET_CATEGORY);


ALTER TABLE SEAT_AVAILABLE ADD CONSTRAINT SAF_KEY FOREIGN KEY (MATCH_NO) REFERENCES MATCH_DETAILS(MATCH_NO) on delete cascade;
ALTER TABLE TICKET_INFO ADD CONSTRAINT TIF_KEY FOREIGN KEY (MATCH_NO) REFERENCES MATCH_DETAILS(MATCH_NO) on delete cascade;
ALTER TABLE BUYER_DETAILS ADD CONSTRAINT BDF_KEY FOREIGN KEY (TICKET_ID) REFERENCES TICKET_INFO(TICKET_ID) on delete cascade;
ALTER TABLE MATCH_DETAILS ADD CONSTRAINT MDF_KEY FOREIGN KEY (TICKET_CATEGORY) REFERENCES TICKET_PRICE(TICKET_CATEGORY) on delete cascade;


INSERT INTO TICKET_PRICE VALUES(1,'GROUP',300);
INSERT INTO TICKET_PRICE VALUES(2,'SUPER',400);
INSERT INTO TICKET_PRICE VALUES(3,'SEMIFINAL',500);
INSERT INTO TICKET_PRICE VALUES(4,'FINAL',600);


INSERT INTO MATCH_DETAILS VALUES(1,'DHA','01-JAN-2017','GROUP','BAN','IND',1);
INSERT INTO MATCH_DETAILS VALUES(2,'CHI','02-JAN-2017','GROUP','AUS','SAF',1);
INSERT INTO MATCH_DETAILS VALUES(3,'KHU','03-JAN-2017','SUPER','NZ','PK',2);
INSERT INTO MATCH_DETAILS VALUES(4,'DHA','05-JAN-2017','SUPER','SL','WI',3);
INSERT INTO MATCH_DETAILS VALUES(5,'KHU','06-JAN-2017','SEMIFINAL','END','ZIM',4);


INSERT INTO SEAT_AVAILABLE VALUES(1,200);
INSERT INTO SEAT_AVAILABLE VALUES(2,100);
INSERT INTO SEAT_AVAILABLE VALUES(3,250);
INSERT INTO SEAT_AVAILABLE VALUES(4,240);
INSERT INTO SEAT_AVAILABLE VALUES(5,40);

INSERT INTO TICKET_INFO VALUES('A1001','N-01','NORMAL',1);
INSERT INTO TICKET_INFO VALUES('B2001','N-02','NORMAL',2);
INSERT INTO TICKET_INFO VALUES('B2002','M-01','MIDDLE',2);
INSERT INTO TICKET_INFO VALUES('A3002','N-02','MIDDLE',3);
INSERT INTO TICKET_INFO VALUES('A3001','M-01','VIP',3);

INSERT INTO BUYER_DETAILS VALUES('A01','A1001',3);
INSERT INTO BUYER_DETAILS VALUES('B01','B2001',1);
INSERT INTO BUYER_DETAILS VALUES('C01','B2002',2);
INSERT INTO BUYER_DETAILS VALUES('D01','A3002',3);
INSERT INTO BUYER_DETAILS VALUES('E01','A3001',2);

COMMIT;